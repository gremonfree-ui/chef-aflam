<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHEF AFLAM | Admin Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { background: #111; color: #fff; font-family: 'Cairo', sans-serif; margin: 0; padding: 20px; direction: rtl; }
        .container { max-width: 800px; margin: 0 auto; background: #222; padding: 20px; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        h1, h2 { color: #FFD700; text-align: center; }
        .section { margin-bottom: 30px; border: 1px solid #444; padding: 15px; border-radius: 8px; }
        label { display: block; margin: 10px 0 5px; color: #ccc; }
        input, textarea { width: 100%; padding: 10px; background: #333; border: 1px solid #555; color: #fff; border-radius: 5px; box-sizing: border-box; }
        .item { background: #1a1a1a; padding: 10px; margin-bottom: 10px; border-radius: 5px; position: relative; border-right: 3px solid #FFD700; }
        .btn { padding: 10px 20px; border: none; cursor: pointer; border-radius: 5px; font-weight: bold; margin-top: 10px; }
        .btn-save { background: #FFD700; color: #000; width: 100%; font-size: 1.2rem; }
        .btn-add { background: #28a745; color: #fff; }
        .btn-del { background: #dc3545; color: #fff; position: absolute; top: 10px; left: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø´ÙŠÙ Ø£ÙÙ„Ø§Ù… ğŸ› ï¸</h1>
        
        <div class="section">
            <h2>ğŸ‘¤ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©</h2>
            <label>Ø§Ù„Ø¨Ø§ÙŠÙˆ (Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ)</label><textarea id="bio_en" rows="3"></textarea>
            <label>Ø§Ù„Ø¨Ø§ÙŠÙˆ (Ø¹Ø±Ø¨ÙŠ)</label><textarea id="bio_ar" rows="3"></textarea>
        </div>

        <div class="section">
            <h2>ğŸ¬ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„ÙŠÙˆØªÙŠÙˆØ¨ (Home)</h2>
            <div id="home_list"></div>
            <button class="btn btn-add" onclick="addItem('home_list')">+ Ø¥Ø¶Ø§ÙØ© ÙÙŠØ¯ÙŠÙˆ</button>
        </div>

        <div class="section">
            <h2>âœ‚ï¸ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ù…ÙˆÙ†ØªØ§Ø¬ (Editing)</h2>
            <div id="editing_list"></div>
            <button class="btn btn-add" onclick="addItem('editing_list')">+ Ø¥Ø¶Ø§ÙØ© ÙÙŠØ¯ÙŠÙˆ</button>
        </div>

        <div class="section">
            <h2>ğŸ¤– ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ (AI)</h2>
            <h3>âœ¨ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ù…ÙŠØ² (Trailer)</h3>
            <label>Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù</label><input id="ai_feat_file">
            <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (EN)</label><input id="ai_feat_en">
            <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (AR)</label><input id="ai_feat_ar">
            <hr style="border-color:#444; margin:20px 0">
            <h3>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª</h3>
            <div id="ai_list"></div>
            <button class="btn btn-add" onclick="addItem('ai_list')">+ Ø¥Ø¶Ø§ÙØ© ÙÙŠØ¯ÙŠÙˆ</button>
        </div>

        <button class="btn btn-save" onclick="saveData()">ğŸ’¾ Ø­ÙØ¸ ÙˆØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ«</button>
    </div>

    <script src="db.js"></script>
    <script>
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
        document.getElementById('bio_en').value = db.profile.bio_en;
        document.getElementById('bio_ar').value = db.profile.bio_ar;
        
        // Ø§Ù„ØªØ±ÙŠÙ„Ø±
        document.getElementById('ai_feat_file').value = db.ai_featured.file;
        document.getElementById('ai_feat_en').value = db.ai_featured.title_en;
        document.getElementById('ai_feat_ar').value = db.ai_featured.title_ar;

        // Ø¯Ø§Ù„Ø© Ø±Ø³Ù… Ø§Ù„Ø¹Ù†Ø§ØµØ±
        function renderList(id, data, isFile = false) {
            const container = document.getElementById(id);
            container.innerHTML = '';
            data.forEach((item, index) => {
                let html = `<div class="item">
                    <button class="btn btn-del" onclick="delItem('${id}', ${index})">Ø­Ø°Ù</button>
                    <label>${isFile ? 'Ø§Ø³Ù… Ù…Ù„Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ/Ø§Ù„ØµÙˆØ±Ø©' : 'YouTube ID'}</label>
                    <input class="val-link" value="${item.id || item.file || item}">`;
                
                if(item.title_en !== undefined) {
                    html += `<label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (EN)</label><input class="val-en" value="${item.title_en}">
                             <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (AR)</label><input class="val-ar" value="${item.title_ar}">`;
                }
                html += `</div>`;
                container.innerHTML += html;
            });
        }

        renderList('home_list', db.home_videos);
        renderList('editing_list', db.editing_videos, true);
        renderList('ai_list', db.ai_videos, true);

        // Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¥Ø¶Ø§ÙØ© ÙˆØ§Ù„Ø­Ø°Ù
        window.addItem = (id) => {
            const template = id === 'home_list' ? {id:'', title_en:'', title_ar:''} : {file:'', title_en:'', title_ar:''};
            if(id === 'home_list') db.home_videos.push(template);
            else if(id === 'editing_list') db.editing_videos.push(template);
            else if(id === 'ai_list') db.ai_videos.push(template);
            renderList(id, id==='home_list'?db.home_videos:id==='editing_list'?db.editing_videos:db.ai_videos, id!=='home_list');
        }

        window.delItem = (id, index) => {
            if(!confirm('Ù…ØªØ§ÙƒØ¯ Ø¹Ø§ÙŠØ² ØªÙ…Ø³Ø­ØŸ')) return;
            if(id === 'home_list') db.home_videos.splice(index, 1);
            else if(id === 'editing_list') db.editing_videos.splice(index, 1);
            else if(id === 'ai_list') db.ai_videos.splice(index, 1);
            renderList(id, id==='home_list'?db.home_videos:id==='editing_list'?db.editing_videos:db.ai_videos, id!=='home_list');
        }

        // Ø§Ù„Ø­ÙØ¸
        window.saveData = () => {
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯Ø§ØªØ§ Ù…Ù† Ø§Ù„Ø®Ø§Ù†Ø§Øª
            db.profile.bio_en = document.getElementById('bio_en').value;
            db.profile.bio_ar = document.getElementById('bio_ar').value;
            db.ai_featured = {
                file: document.getElementById('ai_feat_file').value,
                title_en: document.getElementById('ai_feat_en').value,
                title_ar: document.getElementById('ai_feat_ar').value
            };
            
            // Ø¯Ø§Ù„Ø© Ù„Ø³Ø­Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…
            const scrape = (id, isFile) => {
                const items = document.querySelectorAll(`#${id} .item`);
                return Array.from(items).map(div => ({
                    [isFile ? 'file' : 'id']: div.querySelector('.val-link').value,
                    title_en: div.querySelector('.val-en').value,
                    title_ar: div.querySelector('.val-ar').value
                }));
            };

            db.home_videos = scrape('home_list', false);
            db.editing_videos = scrape('editing_list', true);
            db.ai_videos = scrape('ai_list', true);

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø¬Ø¯ÙŠØ¯
            const content = "const db = " + JSON.stringify(db, null, 4) + ";";
            const blob = new Blob([content], {type: "text/javascript"});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'db.js';
            a.click();
            alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø§Ù„ØªØ­Ø¯ÙŠØ«! \n1. Ø§Ù„Ù…Ù„Ù Ù†Ø²Ù„ Ø¹Ù†Ø¯Ùƒ ÙÙŠ Ø§Ù„Ù€ Downloads\n2. Ø®Ø¯Ù‡ ÙˆØ­Ø·Ù‡ Ù…ÙƒØ§Ù† Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù‚Ø¯ÙŠÙ… ÙÙŠ ÙÙˆÙ„Ø¯Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹\n3. Ø§Ø±ÙØ¹Ù‡ Ø¹Ù„Ù‰ GitHub ÙˆÙ…Ø¨Ø±ÙˆÙƒ Ø¹Ù„ÙŠÙƒ Ø§Ù„ØªØ­Ø¯ÙŠØ«!');
        };
    </script>
</body>
</html>